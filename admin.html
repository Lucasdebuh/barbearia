<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Administrativo Avançado</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body onload="initAdmin()">

    <!-- Modal de Login -->
    <div id="login-modal" class="login-overlay">
        <div class="login-container">
            <div class="login-icon">
                <i class="fas fa-shield-alt"></i>
            </div>
            <h3 class="login-title">Acesso Administrativo</h3>
            <p class="login-subtitle">Digite a senha de administrador</p>
            
            <div class="login-form">
                <div class="input-group-custom">
                    <i class="fas fa-lock"></i>
                    <input type="password" id="admin-pass" class="form-control" 
                           placeholder="Senha padrão: admin">
                </div>
                <button class="btn btn-primary btn-block btn-lg" onclick="checkLogin()">
                    <i class="fas fa-sign-in-alt"></i> Entrar no Painel
                </button>
                <a href="index.html" class="btn btn-link btn-block mt-3">
                    <i class="fas fa-arrow-left"></i> Voltar ao Site
                </a>
            </div>
        </div>
    </div>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <i class="fas fa-cut"></i>
            <span id="sidebar-shop-name">Admin Panel</span>
        </div>
        <ul class="sidebar-menu">
            <li class="active" onclick="showSection('dashboard')">
                <i class="fas fa-chart-line"></i> Dashboard
            </li>
            <li onclick="showSection('agendamentos')">
                <i class="fas fa-calendar-check"></i> Agendamentos
                <span class="badge badge-danger" id="badge-today">0</span>
            </li>
            <li onclick="showSection('barbeiros')">
                <i class="fas fa-user-tie"></i> Barbeiros
            </li>
            <li onclick="showSection('servicos')">
                <i class="fas fa-scissors"></i> Serviços
            </li>
            <li onclick="showSection('pagamentos')">
                <i class="fas fa-credit-card"></i> Pagamentos
            </li>
            <li onclick="showSection('configuracoes')">
                <i class="fas fa-cogs"></i> Configurações
            </li>
            <li onclick="showSection('relatorios')">
                <i class="fas fa-file-invoice-dollar"></i> Relatórios
            </li>
        </ul>
        <div class="sidebar-footer">
            <button class="btn btn-outline-light btn-sm btn-block" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i> Sair
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Top Navbar -->
        <nav class="navbar navbar-dark bg-admin">
            <div class="container-fluid">
                <button class="btn btn-link text-white" onclick="toggleSidebar()">
                    <i class="fas fa-bars fa-lg"></i>
                </button>
                <span class="navbar-brand mb-0">
                    <i class="fas fa-user-shield"></i> Painel Administrativo
                </span>
                <div class="navbar-actions">
                    <span class="text-white mr-3">
                        <i class="fas fa-bell"></i>
                        <span class="badge badge-danger">3</span>
                    </span>
                    <a href="index.html" class="btn btn-outline-light btn-sm" target="_blank">
                        <i class="fas fa-external-link-alt"></i> Ver Site
                    </a>
                </div>
            </div>
        </nav>

        <!-- Dashboard Section -->
        <div class="admin-section active" id="section-dashboard">
            <div class="container-fluid py-4">
                <h2 class="section-title"><i class="fas fa-chart-line"></i> Dashboard</h2>
                
                <!-- Cards de Estatísticas -->
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="stat-card blue">
                            <div class="stat-icon"><i class="fas fa-calendar-check"></i></div>
                            <div class="stat-content">
                                <div class="stat-value" id="stat-today">0</div>
                                <div class="stat-label">Agendamentos Hoje</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card green">
                            <div class="stat-icon"><i class="fas fa-dollar-sign"></i></div>
                            <div class="stat-content">
                                <div class="stat-value" id="stat-revenue">R$ 0</div>
                                <div class="stat-label">Receita do Mês</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card purple">
                            <div class="stat-icon"><i class="fas fa-users"></i></div>
                            <div class="stat-content">
                                <div class="stat-value" id="stat-clients">0</div>
                                <div class="stat-label">Total de Clientes</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card orange">
                            <div class="stat-icon"><i class="fas fa-user-tie"></i></div>
                            <div class="stat-content">
                                <div class="stat-value" id="stat-barbers">0</div>
                                <div class="stat-label">Barbeiros Ativos</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gráfico e Próximos Agendamentos -->
                <div class="row">
                    <div class="col-md-8">
                        <div class="admin-card">
                            <div class="admin-card-header">
                                <h5><i class="fas fa-chart-bar"></i> Agendamentos da Semana</h5>
                            </div>
                            <div class="admin-card-body">
                                <canvas id="weekChart" height="80"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="admin-card">
                            <div class="admin-card-header">
                                <h5><i class="fas fa-clock"></i> Próximos Agendamentos</h5>
                            </div>
                            <div class="admin-card-body p-0">
                                <ul id="upcoming-list" class="upcoming-list">
                                    <!-- Lista será preenchida aqui -->
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Agendamentos Section -->
        <div class="admin-section" id="section-agendamentos">
            <div class="container-fluid py-4">
                <h2 class="section-title"><i class="fas fa-calendar-check"></i> Agendamentos</h2>
                
                <div class="admin-card">
                    <div class="admin-card-header d-flex justify-content-between align-items-center">
                        <div>
                            <h5 class="mb-0"><i class="fas fa-calendar-alt"></i> Agenda do Dia</h5>
                            <small class="text-muted" id="current-date-display"></small>
                        </div>
                        <div class="d-flex gap-2">
                            <input type="date" id="admin-date" class="form-control date-picker">
                            <button class="btn btn-primary" onclick="refreshAppointments()">
                                <i class="fas fa-sync-alt"></i> Atualizar
                            </button>
                        </div>
                    </div>
                    <div class="admin-card-body p-0">
                        <div id="appt-stats" class="stats-bar"></div>
                        <div class="table-responsive">
                            <table class="table table-hover mb-0" id="appt-table">
                                <thead>
                                    <tr>
                                        <th><i class="fas fa-clock"></i> Horário</th>
                                        <th><i class="fas fa-user"></i> Cliente</th>
                                        <th><i class="fas fa-phone"></i> Contato</th>
                                        <th><i class="fas fa-user-tie"></i> Barbeiro</th>
                                        <th><i class="fas fa-scissors"></i> Serviço</th>
                                        <th><i class="fas fa-dollar-sign"></i> Valor</th>
                                        <th><i class="fas fa-credit-card"></i> Pagamento</th>
                                        <th><i class="fas fa-check-circle"></i> Status</th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="appt-list">
                                    <tr>
                                        <td colspan="9" class="text-center py-5 text-muted">
                                            <i class="fas fa-spinner fa-spin fa-2x mb-3"></i>
                                            <p>Carregando agendamentos...</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Barbeiros Section -->
        <div class="admin-section" id="section-barbeiros">
            <div class="container-fluid py-4">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2 class="section-title mb-0"><i class="fas fa-user-tie"></i> Gerenciar Barbeiros</h2>
                    <button class="btn btn-success btn-lg" onclick="openBarberModal()">
                        <i class="fas fa-plus"></i> Novo Barbeiro
                    </button>
                </div>
                
                <div class="row" id="barbers-admin-list">
                    <!-- Cards de barbeiros serão carregados aqui -->
                </div>
            </div>
        </div>

        <!-- Serviços Section -->
        <div class="admin-section" id="section-servicos">
            <div class="container-fluid py-4">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2 class="section-title mb-0"><i class="fas fa-scissors"></i> Serviços e Preços</h2>
                    <button class="btn btn-success btn-lg" onclick="openServiceModal()">
                        <i class="fas fa-plus"></i> Novo Serviço
                    </button>
                </div>
                
                <div class="row" id="services-list">
                    <!-- Cards de serviços serão carregados aqui -->
                </div>
            </div>
        </div>

        <!-- Pagamentos Section -->
        <div class="admin-section" id="section-pagamentos">
            <div class="container-fluid py-4">
                <h2 class="section-title"><i class="fas fa-credit-card"></i> Integração de Pagamentos</h2>
                
                <div class="row">
                    <div class="col-md-8">
                        <div class="admin-card">
                            <div class="admin-card-header">
                                <h5><i class="fab fa-cc-mercadopago"></i> Mercado Pago</h5>
                            </div>
                            <div class="admin-card-body">
                                <div class="alert alert-info">
                                    <i class="fas fa-info-circle"></i>
                                    <strong>Como configurar:</strong> Cadastre suas credenciais do Mercado Pago abaixo para habilitar pagamentos online.
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-key"></i> Access Token (Produção)
                                    </label>
                                    <input type="password" id="mp-access-token" class="form-control" 
                                           placeholder="APP_USR-XXXXXXXX-XXXXXXXX">
                                    <small class="form-text text-muted">
                                        Obtenha em: <a href="https://www.mercadopago.com.br/developers/panel/credentials" target="_blank">Painel do Desenvolvedor</a>
                                    </small>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-key"></i> Public Key
                                    </label>
                                    <input type="text" id="mp-public-key" class="form-control" 
                                           placeholder="APP_USR-XXXXXXXX-XXXXXXXX">
                                </div>

                                <div class="custom-control custom-switch mb-3">
                                    <input type="checkbox" class="custom-control-input" id="mp-active">
                                    <label class="custom-control-label" for="mp-active">
                                        Habilitar pagamentos online
                                    </label>
                                </div>

                                <button class="btn btn-success btn-lg" onclick="savePaymentConfig()">
                                    <i class="fas fa-save"></i> Salvar Configurações
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="admin-card">
                            <div class="admin-card-header">
                                <h5><i class="fas fa-chart-pie"></i> Estatísticas de Pagamento</h5>
                            </div>
                            <div class="admin-card-body">
                                <div class="payment-stat">
                                    <span class="payment-stat-label">
                                        <i class="fas fa-qrcode text-success"></i> Online
                                    </span>
                                    <span class="payment-stat-value" id="stat-online">R$ 0,00</span>
                                </div>
                                <div class="payment-stat">
                                    <span class="payment-stat-label">
                                        <i class="fas fa-store text-primary"></i> No Local
                                    </span>
                                    <span class="payment-stat-value" id="stat-local">R$ 0,00</span>
                                </div>
                                <hr>
                                <div class="payment-stat">
                                    <span class="payment-stat-label">
                                        <strong>Total do Mês</strong>
                                    </span>
                                    <span class="payment-stat-value text-success" id="stat-total">
                                        <strong>R$ 0,00</strong>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Configurações Section -->
        <div class="admin-section" id="section-configuracoes">
            <div class="container-fluid py-4">
                <h2 class="section-title"><i class="fas fa-cogs"></i> Configurações Gerais</h2>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="admin-card">
                            <div class="admin-card-header">
                                <h5><i class="fas fa-store"></i> Informações da Loja</h5>
                            </div>
                            <div class="admin-card-body">
                                <div class="form-group">
                                    <label class="form-label">Nome da Barbearia</label>
                                    <input type="text" id="cfg-name" class="form-control">
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Cor Principal do Site</label>
                                    <div class="color-picker-wrapper">
                                        <input type="color" id="cfg-color" class="color-input">
                                        <span class="color-preview" id="color-preview"></span>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-6">
                                        <div class="form-group">
                                            <label class="form-label">Horário de Abertura</label>
                                            <input type="number" id="cfg-start" class="form-control" min="0" max="23">
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="form-group">
                                            <label class="form-label">Horário de Fechamento</label>
                                            <input type="number" id="cfg-end" class="form-control" min="0" max="23">
                                        </div>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Tempo Padrão de Atendimento</label>
                                    <select id="cfg-duration" class="form-control">
                                        <option value="30">30 minutos</option>
                                        <option value="45">45 minutos</option>
                                        <option value="60">1 hora</option>
                                        <option value="90">1h 30min</option>
                                    </select>
                                </div>

                                <button class="btn btn-success btn-lg btn-block" onclick="saveSettings()">
                                    <i class="fas fa-save"></i> Salvar Alterações
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="admin-card">
                            <div class="admin-card-header bg-danger text-white">
                                <h5><i class="fas fa-exclamation-triangle"></i> Zona de Perigo</h5>
                            </div>
                            <div class="admin-card-body">
                                <p class="text-muted">
                                    <i class="fas fa-info-circle"></i> As ações abaixo são irreversíveis. Proceda com cuidado.
                                </p>
                                
                                <button class="btn btn-warning btn-block mb-2" onclick="exportData()">
                                    <i class="fas fa-download"></i> Exportar Todos os Dados (JSON)
                                </button>
                                
                                <button class="btn btn-danger btn-block" onclick="resetSystem()">
                                    <i class="fas fa-trash-alt"></i> Limpar Todos os Dados
                                </button>
                            </div>
                        </div>

                        <div class="admin-card mt-3">
                            <div class="admin-card-header">
                                <h5><i class="fas fa-lock"></i> Segurança</h5>
                            </div>
                            <div class="admin-card-body">
                                <div class="form-group">
                                    <label class="form-label">Nova Senha do Admin</label>
                                    <input type="password" id="new-password" class="form-control" 
                                           placeholder="Digite a nova senha">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Confirme a Senha</label>
                                    <input type="password" id="confirm-password" class="form-control" 
                                           placeholder="Digite novamente">
                                </div>
                                <button class="btn btn-primary btn-block" onclick="changePassword()">
                                    <i class="fas fa-key"></i> Alterar Senha
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Relatórios Section -->
        <div class="admin-section" id="section-relatorios">
            <div class="container-fluid py-4">
                <h2 class="section-title"><i class="fas fa-file-invoice-dollar"></i> Relatórios Financeiros</h2>
                
                <div class="admin-card">
                    <div class="admin-card-header">
                        <h5><i class="fas fa-filter"></i> Filtros</h5>
                    </div>
                    <div class="admin-card-body">
                        <div class="row">
                            <div class="col-md-3">
                                <label>Período:</label>
                                <select class="form-control" id="report-period" onchange="generateReport()">
                                    <option value="today">Hoje</option>
                                    <option value="week">Esta Semana</option>
                                    <option value="month" selected>Este Mês</option>
                                    <option value="custom">Personalizado</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label>Data Inicial:</label>
                                <input type="date" class="form-control" id="report-start">
                            </div>
                            <div class="col-md-3">
                                <label>Data Final:</label>
                                <input type="date" class="form-control" id="report-end">
                            </div>
                            <div class="col-md-3">
                                <label>&nbsp;</label>
                                <button class="btn btn-primary btn-block" onclick="generateReport()">
                                    <i class="fas fa-search"></i> Gerar Relatório
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col-md-12">
                        <div class="admin-card">
                            <div class="admin-card-header">
                                <h5><i class="fas fa-chart-line"></i> Resumo Financeiro</h5>
                            </div>
                            <div class="admin-card-body">
                                <div id="report-content">
                                    <p class="text-muted text-center py-5">
                                        <i class="fas fa-chart-bar fa-3x mb-3"></i><br>
                                        Selecione um período e clique em "Gerar Relatório"
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Modal: Novo/Editar Barbeiro -->
    <div class="modal fade" id="barberModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-user-tie"></i> <span id="barber-modal-title">Novo Barbeiro</span>
                    </h5>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="barber-id">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Nome Completo *</label>
                                <input type="text" id="barber-name" class="form-control" placeholder="Ex: João Silva">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Especialidade</label>
                                <input type="text" id="barber-specialty" class="form-control" placeholder="Ex: Cortes modernos">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Telefone/WhatsApp</label>
                                <input type="tel" id="barber-phone" class="form-control" placeholder="(11) 99999-9999">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Foto (URL)</label>
                                <input type="url" id="barber-photo" class="form-control" 
                                       placeholder="https://exemplo.com/foto.jpg">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Descrição/Biografia</label>
                        <textarea id="barber-bio" class="form-control" rows="3" 
                                  placeholder="Conte um pouco sobre a experiência..."></textarea>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="custom-control custom-switch">
                                <input type="checkbox" class="custom-control-input" id="barber-active" checked>
                                <label class="custom-control-label" for="barber-active">Barbeiro Ativo</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-success" onclick="saveBarber()">
                        <i class="fas fa-save"></i> Salvar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Novo/Editar Serviço -->
    <div class="modal fade" id="serviceModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-scissors"></i> <span id="service-modal-title">Novo Serviço</span>
                    </h5>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="service-id">
                    <div class="form-group">
                        <label>Nome do Serviço *</label>
                        <input type="text" id="service-name" class="form-control" placeholder="Ex: Corte + Barba">
                    </div>
                    <div class="form-group">
                        <label>Preço (R$) *</label>
                        <input type="number" id="service-price" class="form-control" step="0.01" placeholder="50.00">
                    </div>
                    <div class="form-group">
                        <label>Duração (minutos)</label>
                        <input type="number" id="service-duration" class="form-control" placeholder="45">
                    </div>
                    <div class="form-group">
                        <label>Descrição</label>
                        <textarea id="service-description" class="form-control" rows="2"></textarea>
                    </div>
                    <div class="custom-control custom-switch">
                        <input type="checkbox" class="custom-control-input" id="service-active" checked>
                        <label class="custom-control-label" for="service-active">Serviço Ativo</label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-success" onclick="saveService()">
                        <i class="fas fa-save"></i> Salvar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="script.js"></script>
</body>
</html>